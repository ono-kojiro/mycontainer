- name:  setup openvswitch
  hosts:  myserver
  become: true

  tasks:
    - name: enable openvswitch repository
      ansible.builtin.dnf:
        name: centos-release-nfv-openvswitch
        state: present
      when: >-
        ansible_facts['os_family'] == "RedHat" or
        ansible_facts['os_family'] == "Rocky"

    - name: install openvswitch 2.17
      ansible.builtin.dnf:
        name: "{{ item }}"
        state: present
      loop:
      - openvswitch2.17
      - NetworkManager-ovs
      when: >-
        ansible_facts['os_family'] == "RedHat" or
        ansible_facts['os_family'] == "Rocky"

