- name:  enable static IP
  hosts: myhost

  tasks:
  - name: disable dhcp
    ansible.builtin.replace:
      path: /etc/network/interfaces
      regexp: '^(iface .* inet dhcp)'
      replace: '#\1'

  - name: add static IP
    ansible.builtin.blockinfile:
      path: /etc/network/interfaces
      block: |
        auto {{ iface }}
        iface {{ iface }} inet static
          address {{ address }}
          netmask {{ netmask }}
          gateway {{ gateway }}

  
